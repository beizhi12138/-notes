# 初识Spring
 Spring是分层的(控制层/业务层/数据访问层) 对每一层都提供了技术支持。以Ioc(控制反转，可以看IOC设计模式)和Aop(面向切面编程)为内核。

 Spring实际上是一个大容器，包含了开发java程序所需的各种技术。


 用来解决企业级项目开发的复杂度问题-解耦

 特点:
   轻量级，体积小，对代码没有侵入性
   
   控制反转(IoC  Inverse  of Control) 把创建对象的工作交给Spring,Spring在创建对象的时候同
   时可以完成对象属性赋值(DI----依赖注入)

   面向切面编程(Aop Aspect oriented Programming): 可以在不改变原有逻辑的情况下，实现对业务的增强

   容器 Spring不仅可以创建对象，还可以进行存储对象，管理创建的对象
 ## web项目开发中的耦合度问题

  在Servlet中需要调用service的方法，需要在Servlet类中进行Service实例

  在Service中需要调用dao实现类，需要在Service类中进行Service实例

   如果使用new 关键字创建对象
      失去了面向接口编程的灵活性
      代码的侵入性增强(增加了耦合度)，降低了代码的灵活性

      解决方案:在Servlet中定义接口的对象变量，不使用new关键字创建实现类对象，在Servlet的实例化的时候，通过反射动态的给Service对象变量赋值。

      如何实现:Spring框架

## Spring的体系架构
  Spring Boot 工具框架，快速的整合项目

  Spring Framework (Ioc,Aop)

  Spring Data Spring提供的数据访问的客户端(数据库 jpa,redis)

  Spring Cloud 微服务架构

  Spring Security 安全框架

<img src="../img/13.png"/>

### core Container (核心组件)

Spring容器组件，用于完成实例的创建和管理

Core 核心

Beans 实例管理(依赖于Core)

Context spring上下文(容器上下文)

spEl 表达式组件

### Aop ,Aspects

   Spring Aop 组件 提供了面向切面编程的实现

   aop

   aspects

### web
  spring web组件实际上指的即使spring mva

  web spring对web项目的支持

  webmvc springmvc组件

### Data Access
 spring 数据访问组件，基于jdbc封装的

### Test
 Spring的单元测试组件，提供了spring环境下的端元测试支持

# Spring框架部署(IoC)

   Spring IoC容器组件，可以完成对象的创建，对象属性赋值，对象管理

    创建maven空工程

    添加SpringIoC依赖

        Spring Beans

        Spring Core

        Spring Context
        
        Spring Aop

        Spring expression
        起始添加完依赖之后可以发现，主要添加Context就可以了，其他的因为Context也有依赖所以会进行依赖导入

## 创建Spring配置文件
  
  通过配置文件，告诉Spring容器，创建什么对象，给对象属性赋值

  在resources 目录下创建xml文件 ，通常命名为applicationContext.xml

  在导入包之后，有创建xml模板，选择之后，输入文件名即可

## Spring IoC 的使用
 
    使用Spring IoC 创建并管理对象

    首先需要创建一个实体类
```java
package org.example;

public class Student {
    private String name;
    private String sex;
    private int age;

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getSex() {
        return sex;
    }

    public void setSex(String sex) {
        this.sex = sex;
    }

    public int getAge() {
        return age;
    }

    public void setAge(int age) {
        this.age = age;
    }

    @Override
    public String toString() {
        return "Student{" +
                "name='" + name + '\'' +
                ", sex='" + sex + '\'' +
                ", age=" + age +
                '}';
    }
}
```

 创建完成实体类之后，先来看一下传统的创建对象的方式

 ```java
public class Main {
    public static void main(String[] args) {
/*
*  传统创建对象的方式，如果需要修改学生信息的话就需要改动代码
*  */
     Student stu1=new Student();
        stu1.setAge(18);
        stu1.setName("张三");
        stu1.setSex("女");
        System.out.println(stu1);
    }
}
 ```

 使用SpringIoC创建对象和管理对象

  首先需要配置Spring的配置文件

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
       <!-- id 是这个类名称  class是这个类的路径 -->
     <bean id="Studnet" class="org.example.Student">
       <!-- name 就是属性名 value就是属性值 -->
       <property name="age" value="21"></property>
         <property name="name" value="张三"></property>
         <property name="sex" value="女"></property>
         </bean>

</beans>
```
使用Spring创建对象
```java

public class Main {
    //可以看到，当需要去改动的时候并不需要去改动代码，只需要改动配置文件
    public static void main(String[] args) {
        //创建Spring容器
        ClassPathXmlApplicationContext context=new ClassPathXmlApplicationContext("applicationContext.xml");
        //创建Student对象
         Student stu1=(Student) context.getBean("stu");
        System.out.println(stu1);
    }
}
```
## IoC和DI

  IoC (Inverse of Contorl) 控制反转，通过Spring对象工厂完成对象的创建

  DI (Dependency Injection) 依赖注入，在Spring完成对象的创建的同时，依赖Spring完成对象属性的赋值

### IoC
  当我们需要通过Spring对象工厂创建某个类的对象的时候，需要将这个类交给bean标签配置

### 依赖注入
    通过Spring容器给创建的对象属性赋值
    Spring加载配置文件之后，通过创建类的都对象，并给属性赋值

    Spring容器通过反射实现属性注入有三种方式

    set方法注入

    构造器注入

    接口注入

 ```java

public class Main {
    public  static void main (){
        /**
        
        当我们去创建Spring容器的时候，Spring的源码里会去进行解析配置文件
        解析配置文件通过反射去帮助我们创建对象和给属性赋值
        */

// 配置文件



//简单实现

String calssPath="org.example.Student";
Class c=Class.forName(calssPath); 
//创建对象
Object obj=c.newInstans();

//获取类中的属性

Field[] fields=c.getDeclaredFields();

/**
给属性赋值
解析配置文件里的Property
通过name 获取到属性的set方法
在拿到配置文件里的value 进行赋值
 */
    }}
 ```
 #### set方法注入
   在bean标签中，通过配置property标签就是通过set方法注入

```xml

 <bean id="Studnet" class="org.example.Student">
  <property name="age" value="21"></property>
         </bean>
```
 简单类型及字符串，直接通过propery的value属性赋值

##### 引用类型赋值

 ```xml
 <!-- 

    方式1
    在配置文件里通过bean 创建引用类型的类，
    然后通过propery标签的ref属性绑定引用类型的bean 的id
  -->
<bean id="date" class="java.util.Date"></bean>
     <bean id="stu" class="org.example.Student">
         <constructor-arg ref="environment"/>
         <property name="age" value="21"></property>
         <property name="name" value="张三"></property>
         <property name="sex" value="女"></property>
         <property name="date" ref="date"></property>
     </bean>

     <!-- 

        方式2,在propery标签内，直接写bean
      -->
       <bean id="stu" class="org.example.Student">
         <constructor-arg ref="environment"/>
         <property name="age" value="21"></property>
         <property name="name" value="张三"></property>
         <property name="sex" value="女"></property>
         <property name="date">
             <bean class="java.util.Date"></bean>
         </property>
     </bean>
 ```

##### 集合类型
 
######  List
简单类型
 ```xml

 ```