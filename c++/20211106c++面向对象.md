# 内存分区模型
 
        
         代码区:存放函数体的二进制代码，由操作系统进行管理。
         全局区：存放全局变量和静态变量以及全局常量
         栈区:由编译器自动分配释放,存放函数的参数值，局部变量等
         堆区:由程序员分配和释放，若程序员不释放程序结束时由操作系统回收。

         内存四区存在的意义:
          不同区域存放不同的数据，赋予不同的生命周期
        
## 程序运行前
 在程序编译后，生成了exe可执行程序，未执行该区域前分为两个区域。
   
     代码区： 
       存放cpu执行的机器指令
       代码区是共享的，共享的目的是对于频繁被执行的程序，只需要在内存中有一份代码即可，代码区是制度的，使其只读是为了防止程序意外的修改他的指令
    全局区： 
       全局变量和静态变量存放在此
       全局区还包含了常量区，字符串常量和其他常量也存放在此。
       该区域的数据在程序结束后由操作系统释放。

  ## 程序运行后

        
         栈区：
            由编译器进行分配和释放。
            不要返回局部变量的地址，栈区分配的数据由编译器自动释放。
```cpp
#include <iostream>
using namespace std;
int* func(){
    int  a=10;
    return &a;
}
int main(){
    int * p=func();
    cout << *p << endl;//第一次输出正确的值，因为编译器做了保留
    cout << *p << endl;//第二次输出乱码，因为局部变量保存在栈中，栈中的数据编译器进行释放
    system("pause");
    return 0;
}
```
## 程序运行后
  
       堆区 
          由于程序员分配释放，若程序员不释放，则程序结束后由操作系统回收和释放。
          用new关键字在堆区进行开辟内存

```cpp
int* func(){
     /*
      new 关键字用来在堆中开辟内存，new关键字返回的是一个地址
      用指针来保存,指针是局部变量
     */
    int * a=new int(10);
    return a;
}
int main(){
    int * p=func();
    cout << *p << endl;//一直输出10
    cout << *p << endl;//一直输出10,只要不被释放，只有当程序结束时由操作系统释放
    system("pause");
    return 0;
}
```
## new操作符
  c++中用new操作符在堆区开辟内存。
  堆区开辟的内存手动开辟，手动释放，释放delete操作符。
  利用new创建的数据，会返回该数据对应的类型的指针。
```cpp
#include <iostream>
using namespace std;
int * func(){
    int * a=new int(10);
    return a;
 }
void test01(){
    int * p=func();
    cout << *p<<endl;
    cout << *p<<endl;//未释放就一直存在
    delete p;//释放内存
    cout << *p<<endl;//出现乱码
}
void test02(){
    int * arr=new int[10];//在堆内存中放数组
    for(int i=0;i<10;i++){
        arr[i]=i+100;
    }
    for(int i=0;i<10;i++){
        cout << arr[i] << endl;
    }
    delete [] arr;//释放数组内存
    for(int i=0;i<10;i++){
        cout << arr[i] << endl;
    }
}
int main(){
    test02();
    system("pause");
    return 0;
}
```